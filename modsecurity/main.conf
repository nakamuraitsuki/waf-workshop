# --- 1. エンジン設定 (外部ファイルに依存しない) ---
SecRuleEngine On
SecRequestBodyAccess On
SecResponseBodyAccess Off
SecTmpDir /tmp/
SecDataDir /tmp/

# PcreMatchLimit などのエラー回避用
SecPcreMatchLimit 100000
SecPcreMatchLimitRecursion 100000

# --- 2. CRS 基本設定 ---
# これは前のログで「Line 3」を突破したので、パスが正しいことが証明されています
Include /opt/owasp-crs/crs-setup.conf
Include /opt/owasp-crs/rules/REQUEST-901-INITIALIZATION.conf
# --- 3. 演習用：SQLi (ここも /opt/owasp-crs/rules/ 直下にあるはずです) ---

# Include /opt/owasp-crs/rules/REQUEST-942-APPLICATION-ATTACK-SQLI.conf

# --- 4. 判定 (949番は必須ですが、999番はなくても動きます) ---
Include /opt/owasp-crs/rules/REQUEST-949-BLOCKING-EVALUATION.conf